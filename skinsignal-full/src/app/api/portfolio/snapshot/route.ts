import {NextResponse} from "next/server"; import {takeSnapshot} from "@/lib/snapshot"; export const runtime="nodejs"; export const dynamic="force-dynamic"; export async function POST(req:Request){ try{ const {steamId}=await req.json(); if(!/^[0-9]{17}$/.test(String(steamId||""))) return NextResponse.json({ok:false,error:"invalid_steam_id"},{status:400}); const r=await takeSnapshot(String(steamId)); return NextResponse.json({ok:true,...r}); }catch(e:any){ return NextResponse.json({ok:false,error:e?.message||"snapshot_failed"},{status:500}) } }
